#! /usr/bin/env ruby
require 'eventmachine'
require 'arpoon'

EM.run {
	a = Arpoon.load(ARGV.first || '/etc/arpoon.rc')
	a.start

	EM.error_handler {|e|
		$stderr.puts e.message
		$stderr.puts e.backtrace.join("\n")
	}

	%w[INT KILL].each {|sig|
		trap sig do
			d.stop
			
			EM.stop_event_loop
		end
	}
}
